<!DOCTYPE html>
<html lang="en">
    <head>
        <title>
            Resume Print
        </title>
        <script>
            const jobNames = {
                "Canex": {"name":"CANEX 17 Wing","location":"Winnipeg, MB","date":"Jun 2017 - Present","title":"Sales Associate"},
                "Phare Counseling" : {"name":"Phare Counseling","location":"(Remote)","date":"Aug 2021 - Feb 2022","title":"Full Stack Developer"},
                "Video Cellar" : {"name":"Video Cellar","location":"Winnipeg, MB","date":"Oct 2013 - Feb 2016","title":"Video Rental Clerk"},
                "Rogers Plus" : {"name":"Rogers Plus","location":"Winnipeg, MB","date":"Dec 2006 - Aug 2012","title":"Shift Leader"},
                "Seven-Eleven" : {"name":"Seven-Eleven Food Stores","location":"Winnipeg, MB","date":"Aug 2003 - Nov 2006","title":"Sales Associate"},
            }

            document.addEventListener('DOMContentLoaded', () => {
                const queryString = window.location.search;
                const urlParams = new URLSearchParams(queryString);

                document.title = "Ian McInnes - ResumeAndLetterTo" + urlParams.get("companyName").replaceAll(".","").replaceAll(" ","");
                document.getElementById("letterBody").innerHTML = urlParams.get("coverLetter").replaceAll("\n","<br>");

                let summaryIntro = "Dedicated Professional with a multifaceted background in customer service and software development, looking for full time employment in the industry.";
                const summaryLines = urlParams.get("summary").replaceAll("- ","").trim().replace(/\r\n+$/, "").split("\r\n");
                for (const x in summaryLines) {
                    summaryIntro += " " + summaryLines[x];
                }

                summaryIntro += " Skills include:"
                document.getElementById("summaryCellText").innerHTML = summaryIntro;

                // for (const x in summaryLines) {
                //     // const newSummaryListItem = document.createElement("li");
                //     // newSummaryListItem.innerHTML = summaryLines[x];
                //     // document.getElementById("summaryList").appendChild(newSummaryListItem);
                //     document.getElementById("summaryText").innerHTML += summaryLines[x] + ". ";
                // }

                // for (const x in summaryLines) {
                //     // const newSummaryListItem = document.createElement("li");
                //     // newSummaryListItem.innerHTML = summaryLines[x];
                //     // document.getElementById("summaryList").appendChild(newSummaryListItem);
                //     document.getElementById("summaryCellText").innerHTML += summaryLines[x] + ". ";
                // }

                const experienceData = urlParams.get("experience").replace(/\r\n+$/, "").split("\r\n\r\n");
                for (const x in experienceData) {
                    const currentJobData = experienceData[x].replace(/\r\n+$/, "").split("\r\n");
                    const currentJobDiv = document.createElement("div");
                    currentJobDiv.style.width = "90%";
                    currentJobDiv.className = "jobListing";

                    const currentTitleDiv = document.createElement("div");
                    currentTitleDiv.style.height = "30px";
                    currentTitleDiv.style.display = "flex";
                    currentTitleDiv.style.alignItems = "center";

                    const currentJobTitle = document.createElement("p");
                    currentJobTitle.style.fontWeight = "bold";
                    currentJobTitle.style.fontSize = "16px";
                    currentTitleDiv.appendChild(currentJobTitle);
                    currentJobDiv.appendChild(currentTitleDiv);

                    const currentJobSkills = document.createElement("ul");
                    currentJobSkills.className = "jobSkillsList";
                    currentJobDiv.appendChild(currentJobSkills);
 
                    for (const y in currentJobData) {
                        if (y == 0) {
                            let currentJobTitleString = "<h2>";
                            const titleWords = currentJobData[0].toUpperCase().split(" ");
                            for (const a in titleWords) {
                                if (titleWords[a] == "AND") {
                                    currentJobTitleString += titleWords[a] + " ";
                                } else {
                                    currentJobTitleString += "<span>" + titleWords[a][0] + "</span>";
                                    currentJobTitleString += titleWords[a].substring(1,titleWords[a].length) + " ";
                                }
                            }
                            currentJobTitle.innerHTML = currentJobTitleString.trim() + "</h2>";
                        } else {
                            const currentJobSkillItem = document.createElement("li");
                            currentJobSkills.appendChild(currentJobSkillItem);
                            currentJobSkillItem.innerHTML = "\t<b>" + currentJobData[y].replace("- ","")
                                .replace(" to "," </b>to ").replace(" for "," </b>for ")
                                .replace(" with "," </b>with ").replace(" on "," </b>on ").replace(" about "," </b>about ")
                                .replace(" in "," </b>in ").replace(" of "," </b>of ").replace(" by "," </b>by ").replace("languages","languages</b>").replace(", ","</b>, ");
                        }
                    }
                    // document.getElementById("jobExperienceSection").appendChild(currentJobDiv);

                    document.getElementById("resumeJobExperience").appendChild(currentJobDiv);
                }

                const skillLines = urlParams.get("keySkills").replace(/\r\n+$/, "").split("\r\n");

                const historyTable = document.createElement("table");
                historyTable.style.width = "90%";
                const historyTableBody = document.createElement("tbody");
                historyTable.appendChild(historyTableBody);
                for (const d in jobNames) {
                    console.log(jobNames[d]);
                    const historyRow = document.createElement("tr");
                    const titleCell = document.createElement("td");
                    titleCell.style.fontWeight = "bold";
                    titleCell.innerHTML = jobNames[d]["title"];
                    const nameCell = document.createElement("td");
                    nameCell.innerHTML = jobNames[d]["name"];
                    const dateCell = document.createElement("td");
                    dateCell.innerHTML = jobNames[d]["date"];
                    historyRow.appendChild(titleCell);
                    historyRow.appendChild(nameCell);
                    historyRow.appendChild(dateCell);
                    historyTableBody.appendChild(historyRow);
                }
                document.getElementById("resumeWorkHistory").appendChild(historyTable);
            });
        </script>
        <style>
            @media print {
                body {
                    -webkit-print-color-adjust: exact;
                }

                #coverLetterDiv {
                    page-break-after: always;
                }

                .jobListing {
                    break-inside: avoid;
                }

            }

            h1, h2, h3 {
                color: #6781B2;
                font-weight: bold;
                margin: 0px 0px;
            }
            h3 {
                font-size: 12px;
            }
            h3 span {
                font-size: 18px;
            }
            h2 {
                font-size: 12px;
            }
            h2 span {
                font-size: 18px;
            }
            h1 {
                font-size: 40px;
            }
            h1 span {
                font-size: 60px;
            }
            ul {
                padding-left: 15px;
            }
            #jobExperienceSection p, #educationSection p {
                margin: 2px;
            }

            #educationCell p, .jobListing p {
                margin: 2px;
            }

            .jobSkillsList {
                list-style: none;
            }

            .jobSkillsList li:before {
                content: '✓';
            }

            table {
                width: 100%;
            }
            td {
                width: 33.3%;
            }
            #educationHistory p {
                height: 8px;
            }
            #otherQualifications p {
                height: 8px;
            }

        </style>
    </head>
    <body style="margin:0px;font-family: Arial, Helvetica, sans-serif;">
        <div id="coverLetterDiv" style="margin:96px;">
            <div style="font-family: 'Times New Roman', Times, serif;font-size:12.5;">
                <span style="font-weight: bold;font-size:16.5;">Ian McInnes</span>
                <br>
                306-773 Leila Ave. | Winnipeg, MB | R2V 3R6 | (204) 293-1517 | 
                <br>
                imcinnes31@gmail.com
                <br>
                <br>
            </div>
            <div id="letterBody" style="font-family: 'Times New Roman', Times, serif;font-size:12.5;">
    
            </div>
            <div style="font-family: 'Times New Roman', Times, serif;font-size:12.5;">
                <br>
                Sincerely,
                <br>
                <br>
                <img src="20240222_225753.png" style="height:48px">
                <br>
                <br>
                Ian McInnes
            </div>
        </div>  
        
        <div id="resumeHeading" style="text-align:center;">
            <h1><span>I</span>AN <span>M</span>C<span>I</span>NNES</h1>
            <br>
            <hr style="height:4px;background-color:#2C3B57;border:none;">
            <div style="width:100%;height:21px;display:inline-flex;font-size: 12px;padding: 5px 5px;">
                <div style="width:20%;display:flex;align-items:center;">
                    <div class="contactInfo" style="width:21px;height:21px;background-color:#4C5B77;font-weight:bold;margin-right:10px;display:flex;align-items:center;justify-content:center;">P</div>
                    <div id="phoneNumber">(204) 293-1517</div> 
                </div>
                <div style="width:25%;display:flex;align-items:center;">
                    <div class="contactInfo" style="width:21px;height:21px;background-color:#4C5B77;font-weight:bold;margin-right:10px;display:flex;align-items:center;justify-content:center;">E</div>
                    <a id="emailLink" href="mailto:imcinnes31@gmail.com">imcinnes31@gmail.com</a> 
                </div>
                <div style="width:25%;display:flex;align-items:center;">
                    <div class="contactInfo" style="width:21px;height:21px;background-color:#4C5B77;font-weight:bold;margin-right:10px;display:flex;align-items:center;justify-content:center;">G</div>
                    <a id="githubLink" href="github.com/imcinnes31">github.com/imcinnes31</a>  
                </div>
                <div style="width:30%;display:flex;align-items:center;">
                    <div class="contactInfo" style="width:21px;height:21px;background-color:#4C5B77;font-weight:bold;margin-right:10px;display:flex;align-items:center;justify-content:center;">L</div>
                    <a id="linkedinLInk" href="linkedin.com/in/ian-mcinnes-mb">linkedin.com/in/ian-mcinnes-mb</a>  
                </div>
            </div>
            <hr style="height:4px;background-color:#CADEE5;border:none;">
        </div>
        <div style="display:flex;align-items:center;height:30px;background-color:#CADEE5;">
            <h3><span>O</span>BJECTIVE</h3>
        </div>
        <hr>
        <p id="summaryCellText" style="font-size:16px;"></p>  
        <table>
            <tbody>
                <tr>
                    <td>• Full Stack Development</td>
                    <td>• Computer Skills</td>
                    <td>• Logistics and Analytics</td>
                </tr>
                <tr>
                    <td>• Database Management</td>
                    <td>• Application Deployment</td>
                    <td>• Inventory Control</td>
                </tr>
                <tr>
                    <td>• Shipping and Receiving</td>
                    <td>• Cash Management</td>
                    <td>• Financial Planning</td>
                </tr>
            </tbody>
        </table>
        <br>
        <br>
        <div style="display:flex;align-items:center;height:30px;background-color:#CADEE5;">
            <h3><span>J</span>OB <span>S</span>KILLS</h3>
        </div>
        <hr>
        <div id="resumeJobExperience">

        </div>
        <br>
        <div style="display:flex;align-items:center;height:30px;background-color:#CADEE5;">
            <h3><span>W</span>ORK <span>H</span>ISTORY</h3>
        </div>
        <hr>
        <div id="resumeWorkHistory">

        </div>
        <br>
        <div style="display:flex;align-items:center;height:30px;background-color:#CADEE5;">
            <h3><span>E</span>DUCATION</h3>
        </div>
        <hr>
        <div id="educationHistory">
            <p style="font-weight:bold">Red River College, Winnipeg, MB (2019-2021)</p>
            <p>College Certification</p>
            <p>Software Development, Java Programming, SQL Programming</p>
            <p style="font-weight:bold">University of Winnipeg, Winnipeg, MB (2001-2006)</p>
            <p>Bachelor of Arts</p>
            <p>Theatrical Production, Operations and Management</p>
        </div>
        <br>
        <div style="display:flex;align-items:center;height:30px;background-color:#CADEE5;">
            <h3><span>O</span>THER <span>C</span>ERTIFICATIONS</h3>
        </div>
        <hr>
        <div id="otherQualifications">
            <p style="font-weight:bold">Oracle Certified Associate (Java Programming)</p>
            <p style="font-weight:bold">Class 5 Driver's License</p>
        </div>
    </body>
</html>